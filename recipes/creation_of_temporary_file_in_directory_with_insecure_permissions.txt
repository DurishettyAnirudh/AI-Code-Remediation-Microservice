cwe: CWE-379
name: Creation of Temporary File in Directory with Insecure Permissions
languages: unspecified
tags: Base, Incomplete
---
Short Description:
The product creates a temporary file in a directory whose permissions allow unintended
actors to determine the file's existence or otherwise access that file.

Secure Coding Checklist:
Do:
- PHASE:Requirements:Many contemporary languages have functions which properly handle this condition. Older C temp file functions are especially susceptible.
- PHASE:Implementation:Try to store sensitive tempfiles in a directory which is not world readable -- i.e., per-user directories.
- PHASE:Implementation:Avoid using vulnerable temp file functions.
Don't:
- Confidentiality:Avoid situations leading toRead Application Data:NOTE:Since the file is visible and the application which is using the temp file could be known, the attacker has gained information about what the user is doing at that time.

Language-Agnostic Guidance:
On some operating systems, the fact that the temporary file exists may be apparent to any
user with sufficient privileges to access that directory. Since the file is visible, the
application that is using the temporary file could be known. If one has access to list the
processes on the system, the attacker has gained information about what the user is doing
at that time. By correlating this with the applications the user is running, an attacker
could potentially discover what a user's actions are. From this, higher levels of security
could be breached.

::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

::PHASE:Requirements:DESCRIPTION:Many contemporary languages have functions which properly
handle this condition. Older C temp file functions are especially
susceptible.::PHASE:Implementation:DESCRIPTION:Try to store sensitive tempfiles in a
directory which is not world readable -- i.e., per-user
directories.::PHASE:Implementation:DESCRIPTION:Avoid using vulnerable temp file
functions.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
