cwe: CWE-663
name: Use of a Non-reentrant Function in a Concurrent Context
languages: unspecified
tags: Base, Draft
---
Short Description:
The product calls a non-reentrant function in a concurrent context in which a competing
code sequence (e.g. thread or signal handler) may have an opportunity to call the same
function or otherwise influence its state.

Secure Coding Checklist:
Do:
- PHASE:Implementation:Use reentrant functions if available.
- PHASE:Implementation:Add synchronization to your non-reentrant function.
- PHASE:Implementation:In Java, use the ReentrantLock Class.
Don't:
- Integrity:Confidentiality:Other:Avoid situations leading toModify Memory:Avoid situations leading toRead Memory:Avoid situations leading toModify Application Data:Avoid situations leading toRead Application Data:Avoid situations leading toAlter Execution Logic

Language-Agnostic Guidance:
::PHASE:Implementation:DESCRIPTION:Use reentrant functions if
available.::PHASE:Implementation:DESCRIPTION:Add synchronization to your non-reentrant
function.::PHASE:Implementation:DESCRIPTION:In Java, use the ReentrantLock Class.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
