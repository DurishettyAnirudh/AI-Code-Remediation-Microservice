cwe: CWE-266
name: Incorrect Privilege Assignment
languages: unspecified
tags: Base, Draft
---
Short Description:
A product incorrectly assigns a privilege to a particular actor, creating an unintended
sphere of control for that actor.

Secure Coding Checklist:
Do:
- PHASE:Architecture and Design Operation:Very carefully manage the setting, management, and handling of privileges. Explicitly manage trust zones in the software.
- PHASE:Architecture and Design Operation:Environment Hardening:Run your code using the lowest privileges that are required to accomplish the necessary tasks [REF-76]. If possible, create isolated accounts with limited privileges that are only used for a single task. That way, a successful attack will not immediately give the attacker access to the rest of the software or its environment. For example, database applications rarely need to run as the database administrator, especially in day-to-day operations.
Don't:
- Access Control:Avoid situations leading toGain Privileges or Assume Identity:NOTE:A user can access restricted functionality and/or sensitive information that may include administrative functionality and user accounts.

Language-Agnostic Guidance:
::PHASE:Architecture and Design Operation:DESCRIPTION:Very carefully manage the setting,
management, and handling of privileges. Explicitly manage trust zones in the
software.::PHASE:Architecture and Design Operation:STRATEGY:Environment
Hardening:DESCRIPTION:Run your code using the lowest privileges that are required to
accomplish the necessary tasks [REF-76]. If possible, create isolated accounts with
limited privileges that are only used for a single task. That way, a successful attack
will not immediately give the attacker access to the rest of the software or its
environment. For example, database applications rarely need to run as the database
administrator, especially in day-to-day operations.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
