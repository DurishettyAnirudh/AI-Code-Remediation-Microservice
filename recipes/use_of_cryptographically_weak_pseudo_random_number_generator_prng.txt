cwe: CWE-338
name: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)
languages: unspecified
tags: Base, Draft
---
Short Description:
The product uses a Pseudo-Random Number Generator (PRNG) in a security context, but the
PRNG's algorithm is not cryptographically strong.

Secure Coding Checklist:
Do:
- PHASE:Implementation:Use functions or hardware which use a hardware-based random number generation for all crypto. This is the recommended solution. Use CyptGenRandom on Windows, or hw_rand() on Linux.
Don't:
- Access Control:Avoid situations leading toBypass Protection Mechanism:NOTE:If a PRNG is used for authentication and authorization, such as a session ID or a seed for generating a cryptographic key, then an attacker may be able to easily guess the ID or cryptographic key and gain access to restricted functionality.

Language-Agnostic Guidance:
When a non-cryptographic PRNG is used in a cryptographic context, it can expose the
cryptography to certain types of attacks. Often a pseudo-random number generator (PRNG) is
not designed for cryptography. Sometimes a mediocre source of randomness is sufficient or
preferable for algorithms that use random numbers. Weak generators generally take less
processing power and/or do not use the precious, finite, entropy sources on a system.
While such PRNGs might have very useful features, these same features could be used to
break the cryptography.

::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

::PHASE:Implementation:DESCRIPTION:Use functions or hardware which use a hardware-based
random number generation for all crypto. This is the recommended solution. Use
CyptGenRandom on Windows, or hw_rand() on Linux.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
