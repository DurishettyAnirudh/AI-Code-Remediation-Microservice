cwe: CWE-393
name: Return of Wrong Status Code
languages: unspecified
tags: Base, Draft
---
Short Description:
A function or operation returns an incorrect return value or status code that does not
indicate the true result of execution, causing the product to modify its behavior based on
the incorrect result.

Secure Coding Checklist:
Do:
- Apply least privilege, validate input, and follow vendor hardening guides.
Don't:
- Integrity:Other:Avoid situations leading toUnexpected State:Avoid situations leading toAlter Execution Logic:NOTE:This weakness could place the system in a state that could lead unexpected logic to be executed or other unintended behaviors.

Language-Agnostic Guidance:
This can lead to unpredictable behavior. If the function is used to make security-critical
decisions or provide security-critical information, then the wrong status code can cause
the product to assume that an action is safe or correct, even when it is not.

::METHOD:Fuzzing:DESCRIPTION:Fuzz testing (fuzzing) is a powerful technique for generating
large numbers of diverse inputs - either randomly or algorithmically - and dynamically
invoking the code with those inputs. Even with random inputs, it is often capable of
generating unexpected results such as crashes, memory corruption, or resource consumption.
Fuzzing effectively produces repeatable test cases that clearly indicate bugs, which helps
developers to diagnose the issues.:EFFECTIVENESS:High::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
