cwe: CWE-319
name: Cleartext Transmission of Sensitive Information
languages: unspecified
tags: Base, Draft
---
Short Description:
The product transmits sensitive or security-critical data in cleartext in a communication
channel that can be sniffed by unauthorized actors.

Secure Coding Checklist:
Do:
- PHASE:Architecture and Design:Before transmitting, encrypt the data using reliable, confidentiality-protecting cryptographic protocols.
- PHASE:Implementation:When using web applications with SSL, use SSL for the entire session from login to logout, not just for the initial login page.
- PHASE:Implementation:When designing hardware platforms, ensure that approved encryption algorithms (such as those recommended by NIST) protect paths from security critical data to trusted user applications.
- PHASE:Testing:Use tools and techniques that require manual (human) analysis, such as penetration testing, threat modeling, and interactive tools that allow the tester to record and modify an active session. These may be more effective than strictly automated techniques. This is especially the case with weaknesses that are related to design and business rules.
- PHASE:Operation:Configure servers to use encrypted channels for communication, which may include SSL or other secure protocols.
Don't:
- Integrity:Confidentiality:Avoid situations leading toRead Application Data:Avoid situations leading toModify Files or Directories:NOTE:Anyone can read the information by gaining access to the channel being used for communication. Many communication channels can be sniffed (monitored) by adversaries during data transmission. For example, in networking, packets can traverse many intermediary nodes from the source to the destination, whether across the internet, an internal network, the cloud, etc. Some actors might have privileged access to a network interface or any link along the channel, such as a router, but they might not be authorized to collect the underlying data. As a result, network traffic could be sniffed by adversaries, spilling security-critical data.
- Integrity:Confidentiality:Avoid situations leading toRead Application Data:Avoid situations leading toModify Files or Directories:Avoid situations leading toOther:NOTE:When full communications are recorded or logged, such as with a packet dump, an adversary could attempt to obtain the dump long after the transmission has occurred and try to sniff the cleartext from the recorded communications in the dump itself. Even if the information is encoded in a way that is not human-readable, certain techniques could determine which encoding is being used, then decode the information.

Language-Agnostic Guidance:
::METHOD:Black Box:DESCRIPTION:Use monitoring tools that examine the software's process as
it interacts with the operating system and the network. This technique is useful in cases
when source code is unavailable, if the software was not developed by you, or if you want
to verify that the build phase did not introduce any new weaknesses. Examples include
debuggers that directly attach to the running process; system-call tracing utilities such
as truss (Solaris) and strace (Linux); system activity monitors such as FileMon, RegMon,
Process Monitor, and other Sysinternals utilities (Windows); and sniffers and protocol
analyzers that monitor network traffic. Attach the monitor to the process, trigger the
feature that sends the data, and look for the presence or absence of common cryptographic
functions in the call tree. Monitor the network and determine if the data packets contain
readable commands. Tools exist for detecting if certain encodings are in use. If the
traffic contains high entropy, this might indicate the usage of
encryption.::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis,
commonly referred to as Static Application Security Testing (SAST), can find some
instances of this weakness by analyzing source code (or binary/compiled code) without
having to execute it. Typically, this is done by building a model of data flow and control
flow, then searching for potentially-vulnerable patterns that connect sources (origins of
input) with sinks (destinations where the data interacts with external components, a lower
layer such as the OS, etc.):EFFECTIVENESS:High::

::PHASE:Architecture and Design:DESCRIPTION:Before transmitting, encrypt the data using
reliable, confidentiality-protecting cryptographic
protocols.::PHASE:Implementation:DESCRIPTION:When using web applications with SSL, use SSL
for the entire session from login to logout, not just for the initial login
page.::PHASE:Implementation:DESCRIPTION:When designing hardware platforms, ensure that
approved encryption algorithms (such as those recommended by NIST) protect paths from
security critical data to trusted user applications.::PHASE:Testing:DESCRIPTION:Use tools
and techniques that require manual (human) analysis, such as penetration testing, threat
modeling, and interactive tools that allow the tester to record and modify an active
session. These may be more effective than strictly automated techniques. This is
especially the case with weaknesses that are related to design and business
rules.::PHASE:Operation:DESCRIPTION:Configure servers to use encrypted channels for
communication, which may include SSL or other secure protocols.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
