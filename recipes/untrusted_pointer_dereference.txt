cwe: CWE-822
name: Untrusted Pointer Dereference
languages: unspecified
tags: Base, Incomplete, Memory Management
---
Short Description:
The product obtains a value from an untrusted source, converts this value to a pointer,
and dereferences the resulting pointer.

Secure Coding Checklist:
Do:
- Apply least privilege, validate input, and follow vendor hardening guides.
Don't:
- Confidentiality:Avoid situations leading toRead Memory:NOTE:If the untrusted pointer is used in a read operation, an attacker might be able to read sensitive portions of memory.
- Availability:Avoid situations leading toDoS: Crash, Exit, or Restart:NOTE:If the untrusted pointer references a memory location that is not accessible to the product, or points to a location that is malformed or larger than expected by a read or write operation, the application may terminate unexpectedly.
- Integrity:Confidentiality:Availability:Avoid situations leading toExecute Unauthorized Code or Commands:Avoid situations leading toModify Memory:NOTE:If the untrusted pointer is used in a function call, or points to unexpected data in a write operation, then code execution may be possible.

Language-Agnostic Guidance:
An attacker can supply a pointer for memory locations that the product is not expecting.
If the pointer is dereferenced for a write operation, the attack might allow modification
of critical state variables, cause a crash, or execute code. If the dereferencing
operation is for a read, then the attack might allow reading of sensitive data, cause a
crash, or set a variable to an unexpected value (since the value will be read from an
unexpected memory location). There are several variants of this weakness, including but
not necessarily limited to: The untrusted value is directly invoked as a function call. In
OS kernels or drivers where there is a boundary between userland and privileged memory
spaces, an untrusted pointer might enter through an API or system call (see CWE-781 for
one such example). Inadvertently accepting the value from an untrusted control sphere when
it did not have to be accepted as input at all. This might occur when the code was
originally developed to be run by a single user in a non-networked environment, and the
code is then ported to or otherwise exposed to a networked environment.

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
