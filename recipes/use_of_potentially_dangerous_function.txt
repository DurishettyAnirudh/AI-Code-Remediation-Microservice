cwe: CWE-676
name: Use of Potentially Dangerous Function
languages: C, C++
tags: Base, Draft
---
Short Description:
The product invokes a potentially dangerous function that could introduce a vulnerability
if it is used incorrectly, but the function can also be used safely.

Secure Coding Checklist:
Do:
- PHASE:Build and Compilation Implementation:Identify a list of prohibited API functions and prohibit developers from using these functions, providing safer alternatives. In some cases, automatic code analysis tools or the compiler can be instructed to spot use of prohibited functions, such as the banned.h include file from Microsoft's SDL. [REF-554] [REF-7]
Don't:
- Other:Avoid situations leading toVaries by Context:Avoid situations leading toQuality Degradation:Avoid situations leading toUnexpected State:NOTE:If the function is used incorrectly, then it could result in security problems.

Language-Agnostic Guidance:
::METHOD:Automated Static Analysis - Binary or Bytecode:DESCRIPTION:According to SOAR
[REF-1479], the following detection techniques may be useful: Highly cost effective:
Bytecode Weakness Analysis - including disassembler + source code weakness analysis Binary
Weakness Analysis - including disassembler + source code weakness analysis Cost effective
for partial coverage: Binary / Bytecode Quality Analysis Binary / Bytecode simple
extractor - strings, ELF readers, etc.:EFFECTIVENESS:High::METHOD:Manual Static Analysis -
Binary or Bytecode:DESCRIPTION:According to SOAR [REF-1479], the following detection
techniques may be useful: Cost effective for partial coverage: Binary / Bytecode
disassembler - then use manual analysis for vulnerabilities & anomalies:EFFECTIVENESS:SOAR
Partial::METHOD:Dynamic Analysis with Manual Results Interpretation:DESCRIPTION:According
to SOAR [REF-1479], the following detection techniques may be useful: Highly cost
effective: Debugger Cost effective for partial coverage: Monitored Virtual Environment -
run potentially malicious code in sandbox / wrapper / virtual machine, see if it does
anything suspicious:EFFECTIVENESS:High::METHOD:Manual Static Analysis - Source
Code:DESCRIPTION:According to SOAR [REF-1479], the following detection techniques may be
useful: Highly cost effective: Manual Source Code Review (not inspections) Cost effective
for partial coverage: Focused Manual Spotcheck - Focused manual analysis of
source:EFFECTIVENESS:High::METHOD:Automated Static Analysis - Source
Code:DESCRIPTION:According to SOAR [REF-1479], the following detection techniques may be
useful: Highly cost effective: Source code Weakness Analyzer Context-configured Source
Code Weakness Analyzer Cost effective for partial coverage: Warning Flags Source Code
Quality Analyzer:EFFECTIVENESS:High::METHOD:Automated Static
Analysis:DESCRIPTION:According to SOAR [REF-1479], the following detection techniques may
be useful: Cost effective for partial coverage: Origin Analysis:EFFECTIVENESS:SOAR
Partial::METHOD:Architecture or Design Review:DESCRIPTION:According to SOAR [REF-1479],
the following detection techniques may be useful: Highly cost effective: Formal Methods /
Correct-By-Construction Inspection (IEEE 1028 standard) (can apply to requirements,
design, source code, etc.):EFFECTIVENESS:High::

::PHASE:Build and Compilation Implementation:DESCRIPTION:Identify a list of prohibited API
functions and prohibit developers from using these functions, providing safer
alternatives. In some cases, automatic code analysis tools or the compiler can be
instructed to spot use of prohibited functions, such as the banned.h include file from
Microsoft's SDL. [REF-554] [REF-7]::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
