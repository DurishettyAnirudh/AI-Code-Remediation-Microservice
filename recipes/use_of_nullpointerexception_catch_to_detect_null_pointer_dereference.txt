cwe: CWE-395
name: Use of NullPointerException Catch to Detect NULL Pointer Dereference
languages: Java
tags: Base, Draft
---
Short Description:
Catching NullPointerException should not be used as an alternative to programmatic checks
to prevent dereferencing a null pointer.

Secure Coding Checklist:
Do:
- PHASE:Architecture and Design Implementation:Do not extensively rely on catching exceptions (especially for validating user input) to handle errors. Handling exceptions can decrease the performance of an application.
Don't:
- Availability:Avoid situations leading toDoS: Resource Consumption (CPU)

Language-Agnostic Guidance:
Programmers typically catch NullPointerException under three circumstances: The program
contains a null pointer dereference. Catching the resulting exception was easier than
fixing the underlying problem. The program explicitly throws a NullPointerException to
signal an error condition. The code is part of a test harness that supplies unexpected
input to the classes under test. Of these three circumstances, only the last is
acceptable.

::METHOD:Automated Static Analysis - Binary or Bytecode:DESCRIPTION:According to SOAR
[REF-1479], the following detection techniques may be useful: Cost effective for partial
coverage: Bytecode Weakness Analysis - including disassembler + source code weakness
analysis Binary Weakness Analysis - including disassembler + source code weakness
analysis:EFFECTIVENESS:SOAR Partial::METHOD:Dynamic Analysis with Manual Results
Interpretation:DESCRIPTION:According to SOAR [REF-1479], the following detection
techniques may be useful: Cost effective for partial coverage: Framework-based
Fuzzer:EFFECTIVENESS:SOAR Partial::METHOD:Manual Static Analysis - Source
Code:DESCRIPTION:According to SOAR [REF-1479], the following detection techniques may be
useful: Cost effective for partial coverage: Manual Source Code Review (not
inspections):EFFECTIVENESS:SOAR Partial::METHOD:Automated Static Analysis - Source
Code:DESCRIPTION:According to SOAR [REF-1479], the following detection techniques may be
useful: Highly cost effective: Source code Weakness Analyzer Context-configured Source
Code Weakness Analyzer:EFFECTIVENESS:High::METHOD:Architecture or Design
Review:DESCRIPTION:According to SOAR [REF-1479], the following detection techniques may be
useful: Highly cost effective: Formal Methods / Correct-By-Construction Cost effective for
partial coverage: Inspection (IEEE 1028 standard) (can apply to requirements, design,
source code, etc.):EFFECTIVENESS:High::

::PHASE:Architecture and Design Implementation:DESCRIPTION:Do not extensively rely on
catching exceptions (especially for validating user input) to handle errors. Handling
exceptions can decrease the performance of an application.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
