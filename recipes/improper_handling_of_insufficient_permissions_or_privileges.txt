cwe: CWE-280
name: Improper Handling of Insufficient Permissions or Privileges
languages: unspecified
tags: Base, Draft
---
Short Description:
The product does not handle or incorrectly handles when it has insufficient privileges to
access resources or functionality as specified by their permissions. This may cause it to
follow unexpected code paths that may leave the product in an invalid state.

Secure Coding Checklist:
Do:
- PHASE:Architecture and Design:Separation of Privilege:Compartmentalize the system to have safe areas where trust boundaries can be unambiguously drawn. Do not allow sensitive data to go outside of the trust boundary and always be careful when interfacing with a compartment outside of the safe area. Ensure that appropriate compartmentalization is built into the system design, and the compartmentalization allows for and reinforces privilege separation functionality. Architects and designers should rely on the principle of least privilege to decide the appropriate time to use privileges and the time to drop privileges.
- PHASE:Implementation:Always check to see if you have successfully accessed a resource or system functionality, and use proper error handling if it is unsuccessful. Do this even when you are operating in a highly privileged mode, because errors or environmental conditions might still cause a failure. For example, environments with highly granular permissions/privilege models, such as Windows or Linux capabilities, can cause unexpected failures.
Don't:
- Other:Avoid situations leading toOther:Avoid situations leading toAlter Execution Logic

Language-Agnostic Guidance:
::PHASE:Architecture and Design:STRATEGY:Separation of
Privilege:DESCRIPTION:Compartmentalize the system to have safe areas where trust
boundaries can be unambiguously drawn. Do not allow sensitive data to go outside of the
trust boundary and always be careful when interfacing with a compartment outside of the
safe area. Ensure that appropriate compartmentalization is built into the system design,
and the compartmentalization allows for and reinforces privilege separation functionality.
Architects and designers should rely on the principle of least privilege to decide the
appropriate time to use privileges and the time to drop
privileges.::PHASE:Implementation:DESCRIPTION:Always check to see if you have successfully
accessed a resource or system functionality, and use proper error handling if it is
unsuccessful. Do this even when you are operating in a highly privileged mode, because
errors or environmental conditions might still cause a failure. For example, environments
with highly granular permissions/privilege models, such as Windows or Linux capabilities,
can cause unexpected failures.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
