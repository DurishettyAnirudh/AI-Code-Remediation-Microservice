cwe: CWE-294
name: Authentication Bypass by Capture-replay
languages: unspecified
tags: Base, Incomplete
---
Short Description:
A capture-replay flaw exists when the design of the product makes it possible for a
malicious user to sniff network traffic and bypass authentication by replaying it to the
server in question to the same effect as the original message (or with minor changes).

Secure Coding Checklist:
Do:
- PHASE:Architecture and Design:Utilize some sequence or time stamping functionality along with a checksum which takes this into account in order to ensure that messages can be parsed only once.
- PHASE:Architecture and Design:Since any attacker who can listen to traffic can see sequence numbers, it is necessary to sign messages with some kind of cryptography to ensure that sequence numbers are not simply doctored along with content.
Don't:
- Access Control:Avoid situations leading toGain Privileges or Assume Identity:NOTE:Messages sent with a capture-relay attack allow access to resources which are not otherwise accessible without proper authentication.

Language-Agnostic Guidance:
Capture-replay attacks are common and can be difficult to defeat without cryptography.
They are a subset of network injection attacks that rely on observing previously-sent
valid commands, then changing them slightly if necessary and resending the same commands
to the server.

::PHASE:Architecture and Design:DESCRIPTION:Utilize some sequence or time stamping
functionality along with a checksum which takes this into account in order to ensure that
messages can be parsed only once.::PHASE:Architecture and Design:DESCRIPTION:Since any
attacker who can listen to traffic can see sequence numbers, it is necessary to sign
messages with some kind of cryptography to ensure that sequence numbers are not simply
doctored along with content.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
