cwe: CWE-312
name: Cleartext Storage of Sensitive Information
languages: unspecified
tags: Base, Draft
---
Short Description:
The product stores sensitive information in cleartext within a resource that might be
accessible to another control sphere.

Secure Coding Checklist:
Do:
- PHASE:Implementation System Configuration Operation:When storing data in the cloud (e.g., S3 buckets, Azure blobs, Google Cloud Storage, etc.), use the provider's controls to encrypt the data at rest. [REF-1297] [REF-1299] [REF-1301]
- PHASE:Implementation System Configuration Operation:In some systems/environments such as cloud, the use of double encryption (at both the software and hardware layer) might be required, and the developer might be solely responsible for both layers, instead of shared responsibility with the administrator of the broader system/environment.
Don't:
- Confidentiality:Avoid situations leading toRead Application Data:NOTE:An attacker with access to the system could read sensitive information stored in cleartext (i.e., unencrypted). Even if the information is encoded in a way that is not human-readable, certain techniques could determine which encoding is being used, then decode the information.

Language-Agnostic Guidance:
::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

::PHASE:Implementation System Configuration Operation:DESCRIPTION:When storing data in the
cloud (e.g., S3 buckets, Azure blobs, Google Cloud Storage, etc.), use the provider's
controls to encrypt the data at rest. [REF-1297] [REF-1299]
[REF-1301]::PHASE:Implementation System Configuration Operation:DESCRIPTION:In some
systems/environments such as cloud, the use of double encryption (at both the software and
hardware layer) might be required, and the developer might be solely responsible for both
layers, instead of shared responsibility with the administrator of the broader
system/environment.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
