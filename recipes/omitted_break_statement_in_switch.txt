cwe: CWE-484
name: Omitted Break Statement in Switch
languages: C, C++, Java, C#, PHP
tags: Base, Draft
---
Short Description:
The product omits a break statement within a switch or similar construct, causing code
associated with multiple conditions to execute. This can cause problems when the
programmer only intended to execute code associated with one condition.

Secure Coding Checklist:
Do:
- PHASE:Implementation:Omitting a break statement so that one may fall through is often indistinguishable from an error, and therefore should be avoided. If you need to use fall-through capabilities, make sure that you have clearly documented this within the switch statement, and ensure that you have examined all the logical possibilities.
- PHASE:Implementation:The functionality of omitting a break statement could be clarified with an if statement. This method is much safer.
Don't:
- Other:Avoid situations leading toAlter Execution Logic:NOTE:This weakness can cause unintended logic to be executed and other unexpected application behavior.

Language-Agnostic Guidance:
This can lead to critical code executing in situations where it should not.

::METHOD:White Box:DESCRIPTION:Omission of a break statement might be intentional, in
order to support fallthrough. Automated detection methods might therefore be erroneous.
Semantic understanding of expected product behavior is required to interpret whether the
code is correct.::METHOD:Black Box:DESCRIPTION:Since this weakness is associated with a
code construct, it would be indistinguishable from other errors that produce the same
behavior.::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis,
commonly referred to as Static Application Security Testing (SAST), can find some
instances of this weakness by analyzing source code (or binary/compiled code) without
having to execute it. Typically, this is done by building a model of data flow and control
flow, then searching for potentially-vulnerable patterns that connect sources (origins of
input) with sinks (destinations where the data interacts with external components, a lower
layer such as the OS, etc.):EFFECTIVENESS:High::

::PHASE:Implementation:DESCRIPTION:Omitting a break statement so that one may fall through
is often indistinguishable from an error, and therefore should be avoided. If you need to
use fall-through capabilities, make sure that you have clearly documented this within the
switch statement, and ensure that you have examined all the logical
possibilities.::PHASE:Implementation:DESCRIPTION:The functionality of omitting a break
statement could be clarified with an if statement. This method is much safer.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
