cwe: CWE-836
name: Use of Password Hash Instead of Password for Authentication
languages: unspecified
tags: Base, Incomplete
---
Short Description:
The product records password hashes in a data store, receives a hash of a password from a
client, and compares the supplied hash to the hash obtained from the data store.

Secure Coding Checklist:
Do:
- Apply least privilege, validate input, and follow vendor hardening guides.
Don't:
- Access Control:Avoid situations leading toBypass Protection Mechanism:Avoid situations leading toGain Privileges or Assume Identity:NOTE:An attacker could bypass the authentication routine without knowing the original password.

Language-Agnostic Guidance:
Some authentication mechanisms rely on the client to generate the hash for a password,
possibly to reduce load on the server or avoid sending the password across the network.
However, when the client is used to generate the hash, an attacker can bypass the
authentication by obtaining a copy of the hash, e.g. by using SQL injection to compromise
a database of authentication credentials, or by exploiting an information exposure. The
attacker could then use a modified client to replay the stolen hash without having
knowledge of the original password. As a result, the server-side comparison against a
client-side hash does not provide any more security than the use of passwords without
hashing.

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
