cwe: CWE-749
name: Exposed Dangerous Method or Function
languages: unspecified
tags: Base, Incomplete
---
Short Description:
The product provides an Applications Programming Interface (API) or similar interface for
interaction with external actors, but the interface includes a dangerous method or
function that is not properly restricted.

Secure Coding Checklist:
Do:
- PHASE:Architecture and Design:If you must expose a method, make sure to perform input validation on all arguments, limit access to authorized parties, and protect against all possible vulnerabilities.
- PHASE:Architecture and Design Implementation:Attack Surface Reduction:Identify all exposed functionality. Explicitly list all functionality that must be exposed to some user or set of users. Identify which functionality may be: accessible to all users restricted to a small set of privileged users prevented from being directly accessible at all Ensure that the implemented code follows these expectations. This includes setting the appropriate access modifiers where applicable (public, private, protected, etc.) or not marking ActiveX controls safe-for-scripting.
Don't:
- Integrity:Confidentiality:Availability:Access Control:Other:Avoid situations leading toGain Privileges or Assume Identity:Avoid situations leading toRead Application Data:Avoid situations leading toModify Application Data:Avoid situations leading toExecute Unauthorized Code or Commands:Avoid situations leading toOther:NOTE:Exposing critical functionality essentially provides an attacker with the privilege level of the exposed functionality. This could result in the modification or exposure of sensitive data or possibly even execution of arbitrary code.

Language-Agnostic Guidance:
This weakness can lead to a wide variety of resultant weaknesses, depending on the
behavior of the exposed method. It can apply to any number of technologies and approaches,
such as ActiveX controls, Java functions, IOCTLs, and so on. The exposure can occur in a
few different ways: The function/method was never intended to be exposed to outside
actors. The function/method was only intended to be accessible to a limited set of actors,
such as Internet-based access from a single web site.

::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

::PHASE:Architecture and Design:DESCRIPTION:If you must expose a method, make sure to
perform input validation on all arguments, limit access to authorized parties, and protect
against all possible vulnerabilities.::PHASE:Architecture and Design
Implementation:STRATEGY:Attack Surface Reduction:DESCRIPTION:Identify all exposed
functionality. Explicitly list all functionality that must be exposed to some user or set
of users. Identify which functionality may be: accessible to all users restricted to a
small set of privileged users prevented from being directly accessible at all Ensure that
the implemented code follows these expectations. This includes setting the appropriate
access modifiers where applicable (public, private, protected, etc.) or not marking
ActiveX controls safe-for-scripting.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
