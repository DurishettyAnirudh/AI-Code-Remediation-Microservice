cwe: CWE-515
name: Covert Storage Channel
languages: unspecified
tags: Base, Incomplete
---
Short Description:
A covert storage channel transfers information through the setting of bits by one program
and the reading of those bits by another. What distinguishes this case from that of
ordinary operation is that the bits are used to convey encoded information.

Secure Coding Checklist:
Do:
- PHASE:Implementation:Ensure that all reserved fields are set to zero before messages are sent and that no unnecessary information is included.
Don't:
- Confidentiality:Avoid situations leading toRead Application Data:NOTE:Covert storage channels may provide attackers with important information about the system in question.
- Integrity:Confidentiality:Avoid situations leading toRead Application Data:NOTE:If these messages or packets are sent with unnecessary data contained within, it may tip off malicious listeners as to the process that created the message. With this information, attackers may learn any number of things, including the hardware platform, operating system, or algorithms used by the sender. This information can be of significant value to the user in launching further attacks.

Language-Agnostic Guidance:
Covert storage channels occur when out-of-band data is stored in messages for the purpose
of memory reuse. Covert channels are frequently classified as either storage or timing
channels. Examples would include using a file intended to hold only audit information to
convey user passwords--using the name of a file or perhaps status bits associated with it
that can be read by all users to signal the contents of the file. Steganography,
concealing information in such a manner that no one but the intended recipient knows of
the existence of the message, is a good example of a covert storage channel.

::PHASE:Implementation:DESCRIPTION:Ensure that all reserved fields are set to zero before
messages are sent and that no unnecessary information is included.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
