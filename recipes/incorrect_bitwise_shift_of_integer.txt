cwe: CWE-1335
name: Incorrect Bitwise Shift of Integer
languages: C, C++, C#, Java, JavaScript
tags: Base, Draft
---
Short Description:
An integer value is specified to be shifted by a negative amount or an amount greater than
or equal to the number of bits contained in the value causing an unexpected or
indeterminate result.

Secure Coding Checklist:
Do:
- PHASE:Implementation:Implicitly or explicitly add checks and mitigation for negative or over-shift values.
Don't:
- Integrity:Avoid situations leading toDoS: Crash, Exit, or Restart

Language-Agnostic Guidance:
Specifying a value to be shifted by a negative amount is undefined in various languages.
Various computer architectures implement this action in different ways. The compilers and
interpreters when generating code to accomplish a shift generally do not do a check for
this issue. Specifying an over-shift, a shift greater than or equal to the number of bits
contained in a value to be shifted, produces a result which varies by architecture and
compiler. In some languages, this action is specifically listed as producing an undefined
result.

::PHASE:Implementation:DESCRIPTION:Implicitly or explicitly add checks and mitigation for
negative or over-shift values.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
