cwe: CWE-620
name: Unverified Password Change
languages: unspecified
tags: Base, Draft
---
Short Description:
When setting a new password for a user, the product does not require knowledge of the
original password, or using another form of authentication.

Secure Coding Checklist:
Do:
- PHASE:Architecture and Design:When prompting for a password change, force the user to provide the original password in addition to the new password.
- PHASE:Architecture and Design:Do not use forgotten password functionality. But if you must, ensure that you are only providing information to the actual user, e.g. by using an email address or challenge question that the legitimate user already provided in the past; do not allow the current user to change this identity information until the correct password has been provided.
Don't:
- Access Control:Avoid situations leading toBypass Protection Mechanism:Avoid situations leading toGain Privileges or Assume Identity

Language-Agnostic Guidance:
This could be used by an attacker to change passwords for another user, thus gaining the
privileges associated with that user.

::PHASE:Architecture and Design:DESCRIPTION:When prompting for a password change, force
the user to provide the original password in addition to the new
password.::PHASE:Architecture and Design:DESCRIPTION:Do not use forgotten password
functionality. But if you must, ensure that you are only providing information to the
actual user, e.g. by using an email address or challenge question that the legitimate user
already provided in the past; do not allow the current user to change this identity
information until the correct password has been provided.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
