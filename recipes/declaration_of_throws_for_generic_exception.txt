cwe: CWE-397
name: Declaration of Throws for Generic Exception
languages: C++, C#, Java, Python
tags: Base, Draft
---
Short Description:
The product throws or raises an overly broad exceptions that can hide important details
and produce inappropriate responses to certain conditions.

Secure Coding Checklist:
Do:
- Apply least privilege, validate input, and follow vendor hardening guides.
Don't:
- Non-Repudiation:Other:Avoid situations leading toHide Activities:Avoid situations leading toAlter Execution Logic:NOTE:Throwing a generic exception can hide details about unexpected adversary activities by making it difficult to properly troubleshoot error conditions during execution.

Language-Agnostic Guidance:
Declaring a method to throw Exception or Throwable promotes generic error handling
procedures that make it difficult for callers to perform proper error handling and error
recovery. For example, Java's exception mechanism makes it easy for callers to anticipate
what can go wrong and write code to handle each specific exceptional circumstance.
Declaring that a method throws a generic form of exception defeats this system.

::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
