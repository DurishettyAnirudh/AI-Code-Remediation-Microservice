cwe: CWE-474
name: Use of Function with Inconsistent Implementations
languages: C, PHP
tags: Base, Draft
---
Short Description:
The code uses a function that has inconsistent implementations across operating systems
and versions.

Secure Coding Checklist:
Do:
- PHASE:Architecture and Design Requirements:Do not accept inconsistent behavior from the API specifications when the deviant behavior increase the risk level.
Don't:
- Other:Avoid situations leading toQuality Degradation:Avoid situations leading toVaries by Context

Language-Agnostic Guidance:
The use of inconsistent implementations can cause changes in behavior when the code is
ported or built under a different environment than the programmer expects, which can lead
to security problems in some cases. The implementation of many functions varies by
platform, and at times, even by different versions of the same platform. Implementation
differences can include: Slight differences in the way parameters are interpreted leading
to inconsistent results. Some implementations of the function carry significant security
risks. The function might not be defined on all platforms. The function might change which
return codes it can provide, or change the meaning of its return codes.

::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

::PHASE:Architecture and Design Requirements:DESCRIPTION:Do not accept inconsistent
behavior from the API specifications when the deviant behavior increase the risk level.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
