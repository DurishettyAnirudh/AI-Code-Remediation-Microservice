cwe: CWE-59
name: Improper Link Resolution Before File Access ('Link Following')
languages: unspecified
tags: Base, Draft, File Processing
---
Short Description:
The product attempts to access a file based on the filename, but it does not properly
prevent that filename from identifying a link or shortcut that resolves to an unintended
resource.

Secure Coding Checklist:
Do:
- PHASE:Architecture and Design:Separation of Privilege:Follow the principle of least privilege when assigning access rights to entities in a software system. Denying access to a file can prevent an attacker from replacing that file with a link to a sensitive file. Ensure good compartmentalization in the system to provide protected areas that can be trusted.
Don't:
- Confidentiality:Integrity:Access Control:Avoid situations leading toRead Files or Directories:Avoid situations leading toModify Files or Directories:Avoid situations leading toBypass Protection Mechanism:NOTE:An attacker may be able to traverse the file system to unintended locations and read or overwrite the contents of unexpected files. If the files are used for a security mechanism then an attacker may be able to bypass the mechanism.
- Other:Avoid situations leading toExecute Unauthorized Code or Commands:NOTE:Windows simple shortcuts, sometimes referred to as soft links, can be exploited remotely since a .LNK file can be uploaded like a normal file. This can enable remote execution.

Language-Agnostic Guidance:
::METHOD:Automated Static Analysis - Binary or Bytecode:DESCRIPTION:According to SOAR
[REF-1479], the following detection techniques may be useful: Cost effective for partial
coverage: Bytecode Weakness Analysis - including disassembler + source code weakness
analysis:EFFECTIVENESS:SOAR Partial::METHOD:Manual Static Analysis - Binary or
Bytecode:DESCRIPTION:According to SOAR [REF-1479], the following detection techniques may
be useful: Cost effective for partial coverage: Binary / Bytecode disassembler - then use
manual analysis for vulnerabilities & anomalies:EFFECTIVENESS:SOAR Partial::METHOD:Dynamic
Analysis with Automated Results Interpretation:DESCRIPTION:According to SOAR [REF-1479],
the following detection techniques may be useful: Cost effective for partial coverage: Web
Application Scanner Web Services Scanner Database Scanners:EFFECTIVENESS:SOAR
Partial::METHOD:Dynamic Analysis with Manual Results Interpretation:DESCRIPTION:According
to SOAR [REF-1479], the following detection techniques may be useful: Cost effective for
partial coverage: Fuzz Tester Framework-based Fuzzer:EFFECTIVENESS:SOAR
Partial::METHOD:Manual Static Analysis - Source Code:DESCRIPTION:According to SOAR
[REF-1479], the following detection techniques may be useful: Highly cost effective:
Focused Manual Spotcheck - Focused manual analysis of source Manual Source Code Review
(not inspections):EFFECTIVENESS:High::METHOD:Automated Static Analysis - Source
Code:DESCRIPTION:According to SOAR [REF-1479], the following detection techniques may be
useful: Cost effective for partial coverage: Source code Weakness Analyzer Context-
configured Source Code Weakness Analyzer:EFFECTIVENESS:SOAR Partial::METHOD:Architecture
or Design Review:DESCRIPTION:According to SOAR [REF-1479], the following detection
techniques may be useful: Highly cost effective: Formal Methods / Correct-By-Construction
Cost effective for partial coverage: Inspection (IEEE 1028 standard) (can apply to
requirements, design, source code, etc.):EFFECTIVENESS:High::

::PHASE:Architecture and Design:STRATEGY:Separation of Privilege:DESCRIPTION:Follow the
principle of least privilege when assigning access rights to entities in a software
system. Denying access to a file can prevent an attacker from replacing that file with a
link to a sensitive file. Ensure good compartmentalization in the system to provide
protected areas that can be trusted.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
