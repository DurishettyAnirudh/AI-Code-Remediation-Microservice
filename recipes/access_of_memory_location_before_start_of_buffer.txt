cwe: CWE-786
name: Access of Memory Location Before Start of Buffer
languages: C, C++
tags: Base, Incomplete, Memory Management
---
Short Description:
The product reads or writes to a buffer using an index or pointer that references a memory
location prior to the beginning of the buffer.

Secure Coding Checklist:
Do:
- Apply least privilege, validate input, and follow vendor hardening guides.
Don't:
- Confidentiality:Avoid situations leading toRead Memory:NOTE:For an out-of-bounds read, the attacker may have access to sensitive information. If the sensitive information contains system details, such as the current buffer's position in memory, this knowledge can be used to craft further attacks, possibly with more severe consequences.
- Integrity:Availability:Avoid situations leading toModify Memory:Avoid situations leading toDoS: Crash, Exit, or Restart:NOTE:Out of bounds memory access will very likely result in the corruption of relevant memory, and perhaps instructions, possibly leading to a crash.
- Integrity:Avoid situations leading toModify Memory:Avoid situations leading toExecute Unauthorized Code or Commands:NOTE:If the corrupted memory can be effectively controlled, it may be possible to execute arbitrary code. If the corrupted memory is data rather than instructions, the system will continue to function with improper changes, possibly in violation of an implicit or explicit policy.

Language-Agnostic Guidance:
This typically occurs when a pointer or its index is decremented to a position before the
buffer, when pointer arithmetic results in a position before the beginning of the valid
memory location, or when a negative index is used.

::METHOD:Fuzzing:DESCRIPTION:Fuzz testing (fuzzing) is a powerful technique for generating
large numbers of diverse inputs - either randomly or algorithmically - and dynamically
invoking the code with those inputs. Even with random inputs, it is often capable of
generating unexpected results such as crashes, memory corruption, or resource consumption.
Fuzzing effectively produces repeatable test cases that clearly indicate bugs, which helps
developers to diagnose the issues.:EFFECTIVENESS:High::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
