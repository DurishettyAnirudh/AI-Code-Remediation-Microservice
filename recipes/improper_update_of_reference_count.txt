cwe: CWE-911
name: Improper Update of Reference Count
languages: C, C++
tags: Base, Incomplete
---
Short Description:
The product uses a reference count to manage a resource, but it does not update or
incorrectly updates the reference count.

Secure Coding Checklist:
Do:
- Apply least privilege, validate input, and follow vendor hardening guides.
Don't:
- Availability:Avoid situations leading toDoS: Resource Consumption (Memory):Avoid situations leading toDoS: Resource Consumption (Other):LIKELIHOOD:High:NOTE:An adversary that can cause a resource counter to become inaccurate may be able to create situations where resources are not accounted for and not released, thus causing resources to become scarce for future needs.
- Availability:Avoid situations leading toDoS: Crash, Exit, or Restart:LIKELIHOOD:Low:NOTE:An adversary that can cause a resource counter to become inaccurate may be able to force an error that causes the product to crash or exit out of its current operation.

Language-Agnostic Guidance:
Reference counts can be used when tracking how many objects contain a reference to a
particular resource, such as in memory management or garbage collection. When the
reference count reaches zero, the resource can be de-allocated or reused because there are
no more objects that use it. If the reference count accidentally reaches zero, then the
resource might be released too soon, even though it is still in use. If all objects no
longer use the resource, but the reference count is not zero, then the resource might not
ever be released.

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
