cwe: CWE-551
name: Incorrect Behavior Order: Authorization Before Parsing and Canonicalization
languages: unspecified
tags: Base, Incomplete
---
Short Description:
If a web server does not fully parse requested URLs before it examines them for
authorization, it may be possible for an attacker to bypass authorization protection.

Secure Coding Checklist:
Do:
- PHASE:Architecture and Design:URL Inputs should be decoded and canonicalized to the application's current internal representation before being validated and processed for authorization. Make sure that your application does not decode the same input twice. Such errors could be used to bypass allowlist schemes by introducing dangerous inputs after they have been checked.
Don't:
- Access Control:Avoid situations leading toBypass Protection Mechanism

Language-Agnostic Guidance:
For instance, the character strings /./ and / both mean current directory. If
/SomeDirectory is a protected directory and an attacker requests /./SomeDirectory, the
attacker may be able to gain access to the resource if /./ is not converted to / before
the authorization check is performed.

::PHASE:Architecture and Design:DESCRIPTION:URL Inputs should be decoded and canonicalized
to the application's current internal representation before being validated and processed
for authorization. Make sure that your application does not decode the same input twice.
Such errors could be used to bypass allowlist schemes by introducing dangerous inputs
after they have been checked.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
