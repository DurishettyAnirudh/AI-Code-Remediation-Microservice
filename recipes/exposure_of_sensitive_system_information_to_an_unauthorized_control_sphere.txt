cwe: CWE-497
name: Exposure of Sensitive System Information to an Unauthorized Control Sphere
languages: unspecified
tags: Base, Incomplete
---
Short Description:
The product does not properly prevent sensitive system-level information from being
accessed by unauthorized actors who do not have the same level of access to the underlying
system as the product does.

Secure Coding Checklist:
Do:
- PHASE:Architecture and Design Implementation:Production applications should never use methods that generate internal details such as stack traces and error messages unless that information is directly committed to a log that is not viewable by the end user. All error message text should be HTML entity encoded before being written to the log file to protect against potential cross-site scripting attacks against the viewer of the logs
Don't:
- Confidentiality:Avoid situations leading toRead Application Data

Language-Agnostic Guidance:
Network-based products, such as web applications, often run on top of an operating system
or similar environment. When the product communicates with outside parties, details about
the underlying system are expected to remain hidden, such as path names for data files,
other OS users, installed packages, the application environment, etc. This system
information may be provided by the product itself, or buried within diagnostic or
debugging messages. Debugging information helps an adversary learn about the system and
form an attack plan. An information exposure occurs when system data or debugging
information leaves the program through an output stream or logging function that makes it
accessible to unauthorized parties. Using other weaknesses, an attacker could cause errors
to occur; the response to these errors can reveal detailed system information, along with
other impacts. An attacker can use messages that reveal technologies, operating systems,
and product versions to tune the attack against known vulnerabilities in these
technologies. A product may use diagnostic methods that provide significant implementation
details such as stack traces as part of its error handling mechanism.

::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

::PHASE:Architecture and Design Implementation:DESCRIPTION:Production applications should
never use methods that generate internal details such as stack traces and error messages
unless that information is directly committed to a log that is not viewable by the end
user. All error message text should be HTML entity encoded before being written to the log
file to protect against potential cross-site scripting attacks against the viewer of the
logs::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
