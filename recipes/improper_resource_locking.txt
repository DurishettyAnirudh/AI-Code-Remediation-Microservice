cwe: CWE-413
name: Improper Resource Locking
languages: unspecified
tags: Base, Draft
---
Short Description:
The product does not lock or does not correctly lock a resource when the product must have
exclusive access to the resource.

Secure Coding Checklist:
Do:
- PHASE:Architecture and Design:Use a non-conflicting privilege scheme.
- PHASE:Architecture and Design Implementation:Use synchronization when locking a resource.
Don't:
- Integrity:Availability:Avoid situations leading toModify Application Data:Avoid situations leading toDoS: Instability:Avoid situations leading toDoS: Crash, Exit, or Restart

Language-Agnostic Guidance:
When a resource is not properly locked, an attacker could modify the resource while it is
being operated on by the product. This might violate the product's assumption that the
resource will not change, potentially leading to unexpected behaviors.

::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

::PHASE:Architecture and Design:DESCRIPTION:Use a non-conflicting privilege
scheme.::PHASE:Architecture and Design Implementation:DESCRIPTION:Use synchronization when
locking a resource.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
