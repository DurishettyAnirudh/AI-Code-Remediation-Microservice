cwe: CWE-501
name: Trust Boundary Violation
languages: unspecified
tags: Base, Draft
---
Short Description:
The product mixes trusted and untrusted data in the same data structure or structured
message.

Secure Coding Checklist:
Do:
- Apply least privilege, validate input, and follow vendor hardening guides.
Don't:
- Access Control:Avoid situations leading toBypass Protection Mechanism

Language-Agnostic Guidance:
A trust boundary can be thought of as line drawn through a program. On one side of the
line, data is untrusted. On the other side of the line, data is assumed to be trustworthy.
The purpose of validation logic is to allow data to safely cross the trust boundary - to
move from untrusted to trusted. A trust boundary violation occurs when a program blurs the
line between what is trusted and what is untrusted. By combining trusted and untrusted
data in the same data structure, it becomes easier for programmers to mistakenly trust
unvalidated data.

::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
