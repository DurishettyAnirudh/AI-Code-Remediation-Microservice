cwe: CWE-112
name: Missing XML Validation
languages: unspecified
tags: Base, Draft
---
Short Description:
The product accepts XML from an untrusted source but does not validate the XML against the
proper schema.

Secure Coding Checklist:
Do:
- PHASE:Architecture and Design:Input Validation:Always validate XML input against a known XML Schema or DTD. It is not possible for an XML parser to validate all aspects of a document's content because a parser cannot understand the complete semantics of the data. However, a parser can do a complete and thorough job of checking the document's structure and therefore guarantee to the code that processes the document that the content is well-formed.
Don't:
- Integrity:Avoid situations leading toUnexpected State

Language-Agnostic Guidance:
Most successful attacks begin with a violation of the programmer's assumptions. By
accepting an XML document without validating it against a DTD or XML schema, the
programmer leaves a door open for attackers to provide unexpected, unreasonable, or
malicious input.

::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

::PHASE:Architecture and Design:STRATEGY:Input Validation:DESCRIPTION:Always validate XML
input against a known XML Schema or DTD. It is not possible for an XML parser to validate
all aspects of a document's content because a parser cannot understand the complete
semantics of the data. However, a parser can do a complete and thorough job of checking
the document's structure and therefore guarantee to the code that processes the document
that the content is well-formed.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
