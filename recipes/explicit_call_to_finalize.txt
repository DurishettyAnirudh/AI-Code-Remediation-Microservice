cwe: CWE-586
name: Explicit Call to Finalize()
languages: Java
tags: Base, Draft
---
Short Description:
The product makes an explicit call to the finalize() method from outside the finalizer.

Secure Coding Checklist:
Do:
- PHASE:Implementation Testing:Do not make explicit calls to finalize(). Use static analysis tools to spot such instances.
Don't:
- Integrity:Other:Avoid situations leading toUnexpected State:Avoid situations leading toQuality Degradation

Language-Agnostic Guidance:
While the Java Language Specification allows an object's finalize() method to be called
from outside the finalizer, doing so is usually a bad idea. For example, calling
finalize() explicitly means that finalize() will be called more than once: the first time
will be the explicit call and the last time will be the call that is made after the object
is garbage collected.

::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

::PHASE:Implementation Testing:DESCRIPTION:Do not make explicit calls to finalize(). Use
static analysis tools to spot such instances.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
