cwe: CWE-1007
name: Insufficient Visual Distinction of Homoglyphs Presented to User
languages: unspecified
tags: Base, Incomplete
---
Short Description:
The product displays information or identifiers to a user, but the display mechanism does
not make it easy for the user to distinguish between visually similar or identical glyphs
(homoglyphs), which may cause the user to misinterpret a glyph and perform an unintended,
insecure action.

Secure Coding Checklist:
Do:
- PHASE:Implementation:Use a browser that displays Punycode for IDNs in the URL and status bars, or which color code various scripts in URLs. Due to the prominence of homoglyph attacks, several browsers now help safeguard against this attack via the use of Punycode. For example, Mozilla Firefox and Google Chrome will display IDNs as Punycode if top-level domains do not restrict which characters can be used in domain names or if labels mix scripts for different languages.
- PHASE:Implementation:Use an email client that has strict filters and prevents messages that mix character sets to end up in a user's inbox. Certain email clients such as Google's GMail prevent the use of non-Latin characters in email addresses or in links contained within emails. This helps prevent homoglyph attacks by flagging these emails and redirecting them to a user's spam folder.
Don't:
- Integrity:Confidentiality:Avoid situations leading toOther:NOTE:An attacker may ultimately redirect a user to a malicious website, by deceiving the user into believing the URL they are accessing is a trusted domain. However, the attack can also be used to forge log entries by using homoglyphs in usernames. Homoglyph manipulations are often the first step towards executing advanced attacks such as stealing a user's credentials, Cross-Site Scripting (XSS), or log forgery. If an attacker redirects a user to a malicious site, the attacker can mimic a trusted domain to steal account credentials and perform actions on behalf of the user, without the user's knowledge. Similarly, an attacker could create a username for a website that contains homoglyph characters, making it difficult for an admin to review logs and determine which users performed which actions.

Language-Agnostic Guidance:
Some glyphs, pictures, or icons can be semantically distinct to a program, while appearing
very similar or identical to a human user. These are referred to as homoglyphs. For
example, the lowercase l (ell) and uppercase I (eye) have different character codes, but
these characters can be displayed in exactly the same way to a user, depending on the
font. This can also occur between different character sets. For example, the Latin capital
letter A and the Greek capital letter Α (Alpha) are treated as distinct by programs, but
may be displayed in exactly the same way to a user. Accent marks may also cause letters to
appear very similar, such as the Latin capital letter grave mark À and its equivalent Á
with the acute accent. Adversaries can exploit this visual similarity for attacks such as
phishing, e.g. by providing a link to an attacker-controlled hostname that looks like a
hostname that the victim trusts. In a different use of homoglyphs, an adversary may create
a back door username that is visually similar to the username of a regular user, which
then makes it more difficult for a system administrator to detect the malicious username
while reviewing logs.

::METHOD:Manual Dynamic Analysis:DESCRIPTION:If utilizing user accounts, attempt to submit
a username that contains homoglyphs. Similarly, check to see if links containing
homoglyphs can be sent via email, web browsers, or other
mechanisms.:EFFECTIVENESS:Moderate::

::PHASE:Implementation:DESCRIPTION:Use a browser that displays Punycode for IDNs in the
URL and status bars, or which color code various scripts in URLs. Due to the prominence of
homoglyph attacks, several browsers now help safeguard against this attack via the use of
Punycode. For example, Mozilla Firefox and Google Chrome will display IDNs as Punycode if
top-level domains do not restrict which characters can be used in domain names or if
labels mix scripts for different languages.::PHASE:Implementation:DESCRIPTION:Use an email
client that has strict filters and prevents messages that mix character sets to end up in
a user's inbox. Certain email clients such as Google's GMail prevent the use of non-Latin
characters in email addresses or in links contained within emails. This helps prevent
homoglyph attacks by flagging these emails and redirecting them to a user's spam folder.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
