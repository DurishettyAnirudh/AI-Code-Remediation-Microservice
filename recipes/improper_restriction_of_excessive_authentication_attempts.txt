cwe: CWE-307
name: Improper Restriction of Excessive Authentication Attempts
languages: unspecified
tags: Base, Draft
---
Short Description:
The product does not implement sufficient measures to prevent multiple failed
authentication attempts within a short time frame.

Secure Coding Checklist:
Do:
- PHASE:Architecture and Design:Common protection mechanisms include: Disconnecting the user after a small number of failed attempts Implementing a timeout Locking out a targeted account Requiring a computational task on the user's part.
- PHASE:Architecture and Design:Libraries or Frameworks:Use a vetted library or framework that does not allow this weakness to occur or provides constructs that make this weakness easier to avoid [REF-1482]. Consider using libraries with authentication capabilities such as OpenSSL or the ESAPI Authenticator. [REF-45]
Don't:
- Access Control:Avoid situations leading toBypass Protection Mechanism:NOTE:An attacker could perform an arbitrary number of authentication attempts using different passwords, and eventually gain access to the targeted account using a brute force attack.

Language-Agnostic Guidance:
::METHOD:Dynamic Analysis with Automated Results Interpretation:DESCRIPTION:According to
SOAR [REF-1479], the following detection techniques may be useful: Highly cost effective:
Web Application Scanner Web Services Scanner Database Scanners Cost effective for partial
coverage: Host-based Vulnerability Scanners - Examine configuration for flaws, verifying
that audit mechanisms work, ensure host configuration meets certain predefined
criteria:EFFECTIVENESS:High::METHOD:Dynamic Analysis with Manual Results
Interpretation:DESCRIPTION:According to SOAR [REF-1479], the following detection
techniques may be useful: Highly cost effective: Fuzz Tester Framework-based Fuzzer Cost
effective for partial coverage: Forced Path Execution:EFFECTIVENESS:High::METHOD:Manual
Static Analysis - Source Code:DESCRIPTION:According to SOAR [REF-1479], the following
detection techniques may be useful: Highly cost effective: Focused Manual Spotcheck -
Focused manual analysis of source Manual Source Code Review (not
inspections):EFFECTIVENESS:High::METHOD:Automated Static Analysis - Source
Code:DESCRIPTION:According to SOAR [REF-1479], the following detection techniques may be
useful: Cost effective for partial coverage: Source code Weakness Analyzer Context-
configured Source Code Weakness Analyzer:EFFECTIVENESS:SOAR Partial::METHOD:Automated
Static Analysis:DESCRIPTION:According to SOAR [REF-1479], the following detection
techniques may be useful: Cost effective for partial coverage: Configuration
Checker:EFFECTIVENESS:SOAR Partial::METHOD:Architecture or Design
Review:DESCRIPTION:According to SOAR [REF-1479], the following detection techniques may be
useful: Highly cost effective: Formal Methods / Correct-By-Construction Cost effective for
partial coverage: Inspection (IEEE 1028 standard) (can apply to requirements, design,
source code, etc.):EFFECTIVENESS:High::

::PHASE:Architecture and Design:DESCRIPTION:Common protection mechanisms include:
Disconnecting the user after a small number of failed attempts Implementing a timeout
Locking out a targeted account Requiring a computational task on the user's
part.::PHASE:Architecture and Design:STRATEGY:Libraries or Frameworks:DESCRIPTION:Use a
vetted library or framework that does not allow this weakness to occur or provides
constructs that make this weakness easier to avoid [REF-1482]. Consider using libraries
with authentication capabilities such as OpenSSL or the ESAPI Authenticator. [REF-45]::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
