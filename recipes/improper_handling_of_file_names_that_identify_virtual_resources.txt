cwe: CWE-66
name: Improper Handling of File Names that Identify Virtual Resources
languages: unspecified
tags: Base, Draft, File Processing
---
Short Description:
The product does not handle or incorrectly handles a file name that identifies a virtual
resource that is not directly specified within the directory that is associated with the
file name, causing the product to perform file-based operations on a resource that is not
a file.

Secure Coding Checklist:
Do:
- Apply least privilege, validate input, and follow vendor hardening guides.
Don't:
- Other:Avoid situations leading toOther

Language-Agnostic Guidance:
Virtual file names are represented like normal file names, but they are effectively
aliases for other resources that do not behave like normal files. Depending on their
functionality, they could be alternate entities. They are not necessarily listed in
directories.

::METHOD:Automated Static Analysis - Binary or Bytecode:DESCRIPTION:According to SOAR
[REF-1479], the following detection techniques may be useful: Cost effective for partial
coverage: Bytecode Weakness Analysis - including disassembler + source code weakness
analysis:EFFECTIVENESS:SOAR Partial::METHOD:Manual Static Analysis - Binary or
Bytecode:DESCRIPTION:According to SOAR [REF-1479], the following detection techniques may
be useful: Cost effective for partial coverage: Binary / Bytecode disassembler - then use
manual analysis for vulnerabilities & anomalies:EFFECTIVENESS:SOAR Partial::METHOD:Dynamic
Analysis with Automated Results Interpretation:DESCRIPTION:According to SOAR [REF-1479],
the following detection techniques may be useful: Cost effective for partial coverage: Web
Application Scanner Web Services Scanner Database Scanners:EFFECTIVENESS:SOAR
Partial::METHOD:Dynamic Analysis with Manual Results Interpretation:DESCRIPTION:According
to SOAR [REF-1479], the following detection techniques may be useful: Cost effective for
partial coverage: Fuzz Tester Framework-based Fuzzer:EFFECTIVENESS:SOAR
Partial::METHOD:Manual Static Analysis - Source Code:DESCRIPTION:According to SOAR
[REF-1479], the following detection techniques may be useful: Highly cost effective:
Focused Manual Spotcheck - Focused manual analysis of source Manual Source Code Review
(not inspections):EFFECTIVENESS:High::METHOD:Automated Static Analysis - Source
Code:DESCRIPTION:According to SOAR [REF-1479], the following detection techniques may be
useful: Cost effective for partial coverage: Source code Weakness Analyzer Context-
configured Source Code Weakness Analyzer:EFFECTIVENESS:SOAR Partial::METHOD:Architecture
or Design Review:DESCRIPTION:According to SOAR [REF-1479], the following detection
techniques may be useful: Highly cost effective: Formal Methods / Correct-By-Construction
Cost effective for partial coverage: Inspection (IEEE 1028 standard) (can apply to
requirements, design, source code, etc.):EFFECTIVENESS:High::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
