cwe: CWE-552
name: Files or Directories Accessible to External Parties
languages: unspecified
tags: Base, Draft
---
Short Description:
The product makes files or directories accessible to unauthorized actors, even though they
should not be.

Secure Coding Checklist:
Do:
- PHASE:Implementation System Configuration Operation:When storing data in the cloud (e.g., S3 buckets, Azure blobs, Google Cloud Storage, etc.), use the provider's controls to disable public access.
Don't:
- Confidentiality:Integrity:Avoid situations leading toRead Files or Directories:Avoid situations leading toModify Files or Directories

Language-Agnostic Guidance:
Web servers, FTP servers, and similar servers may store a set of files underneath a root
directory that is accessible to the server's users. Applications may store sensitive files
underneath this root without also using access control to limit which users may request
those files, if any. Alternately, an application might package multiple files or
directories into an archive file (e.g., ZIP or tar), but the application might not exclude
sensitive files that are underneath those directories. In cloud technologies and
containers, this weakness might present itself in the form of misconfigured storage
accounts that can be read or written by a public or anonymous user.

::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

::PHASE:Implementation System Configuration Operation:DESCRIPTION:When storing data in the
cloud (e.g., S3 buckets, Azure blobs, Google Cloud Storage, etc.), use the provider's
controls to disable public access.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
