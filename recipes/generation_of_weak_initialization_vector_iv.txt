cwe: CWE-1204
name: Generation of Weak Initialization Vector (IV)
languages: unspecified
tags: Base, Cryptography, Incomplete
---
Short Description:
The product uses a cryptographic primitive that uses an Initialization Vector (IV), but
the product does not generate IVs that are sufficiently unpredictable or unique according
to the expected cryptographic requirements for that primitive.

Secure Coding Checklist:
Do:
- PHASE:Implementation:Different cipher modes have different requirements for their IVs. When choosing and implementing a mode, it is important to understand those requirements in order to keep security guarantees intact. Generally, it is safest to generate a random IV, since it will be both unpredictable and have a very low chance of being non-unique. IVs do not have to be kept secret, so if generating duplicate IVs is a concern, a list of already-used IVs can be kept and checked against. NIST offers recommendations on generation of IVs for modes of which they have approved. These include options for when random IVs are not practical. For CBC, CFB, and OFB, see [REF-1175]; for GCM, see [REF-1178].
Don't:
- Confidentiality:Avoid situations leading toRead Application Data:NOTE:If the IV is not properly initialized, data that is encrypted can be compromised and information about the data can be leaked. See [REF-1179].

Language-Agnostic Guidance:
By design, some cryptographic primitives (such as block ciphers) require that IVs must
have certain properties for the uniqueness and/or unpredictability of an IV. Primitives
may vary in how important these properties are. If these properties are not maintained,
e.g. by a bug in the code, then the cryptography may be weakened or broken by attacking
the IVs themselves.

::PHASE:Implementation:DESCRIPTION:Different cipher modes have different requirements for
their IVs. When choosing and implementing a mode, it is important to understand those
requirements in order to keep security guarantees intact. Generally, it is safest to
generate a random IV, since it will be both unpredictable and have a very low chance of
being non-unique. IVs do not have to be kept secret, so if generating duplicate IVs is a
concern, a list of already-used IVs can be kept and checked against. NIST offers
recommendations on generation of IVs for modes of which they have approved. These include
options for when random IVs are not practical. For CBC, CFB, and OFB, see [REF-1175]; for
GCM, see [REF-1178].::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
