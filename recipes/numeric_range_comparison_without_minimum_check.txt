cwe: CWE-839
name: Numeric Range Comparison Without Minimum Check
languages: C, C++
tags: Base, Incomplete
---
Short Description:
The product checks a value to ensure that it is less than or equal to a maximum, but it
does not also verify that the value is greater than or equal to the minimum.

Secure Coding Checklist:
Do:
- PHASE:Implementation:Enforcement by Conversion:If the number to be used is always expected to be positive, change the variable type from signed to unsigned or size_t.
- PHASE:Implementation:Input Validation:If the number to be used could have a negative value based on the specification (thus requiring a signed value), but the number should only be positive to preserve code correctness, then include a check to ensure that the value is positive.
Don't:
- Integrity:Confidentiality:Availability:Avoid situations leading toModify Application Data:Avoid situations leading toExecute Unauthorized Code or Commands:NOTE:An attacker could modify the structure of the message or data being sent to the downstream component, possibly injecting commands.
- Availability:Avoid situations leading toDoS: Resource Consumption (Other):NOTE:in some contexts, a negative value could lead to resource consumption.
- Confidentiality:Integrity:Avoid situations leading toModify Memory:Avoid situations leading toRead Memory:NOTE:If a negative value is used to access memory, buffers, or other indexable structures, it could access memory outside the bounds of the buffer.

Language-Agnostic Guidance:
Some products use signed integers or floats even when their values are only expected to be
positive or 0. An input validation check might assume that the value is positive, and only
check for the maximum value. If the value is negative, but the code assumes that the value
is positive, this can produce an error. The error may have security consequences if the
negative value is used for memory allocation, array access, buffer access, etc.
Ultimately, the error could lead to a buffer overflow or other type of memory corruption.
The use of a negative number in a positive-only context could have security implications
for other types of resources. For example, a shopping cart might check that the user is
not requesting more than 10 items, but a request for -3 items could cause the application
to calculate a negative price and credit the attacker's account.

::PHASE:Implementation:STRATEGY:Enforcement by Conversion:DESCRIPTION:If the number to be
used is always expected to be positive, change the variable type from signed to unsigned
or size_t.::PHASE:Implementation:STRATEGY:Input Validation:DESCRIPTION:If the number to be
used could have a negative value based on the specification (thus requiring a signed
value), but the number should only be positive to preserve code correctness, then include
a check to ensure that the value is positive.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
