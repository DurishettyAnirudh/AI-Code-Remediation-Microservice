cwe: CWE-390
name: Detection of Error Condition Without Action
languages: unspecified
tags: Base, Draft
---
Short Description:
The product detects a specific error, but takes no actions to handle the error.

Secure Coding Checklist:
Do:
- PHASE:Implementation:Properly handle each exception. This is the recommended solution. Ensure that all exceptions are handled in such a way that you can be sure of the state of your system at any given moment.
- PHASE:Implementation:If a function returns an error, it is important to either fix the problem and try again, alert the user that an error has happened and let the program continue, or alert the user and close and cleanup the program.
- PHASE:Testing:Subject the product to extensive testing to discover some of the possible instances of where/how errors or return values are not handled. Consider testing techniques such as ad hoc, equivalence partitioning, robustness and fault tolerance, mutation, and fuzzing.
Don't:
- Integrity:Other:Avoid situations leading toVaries by Context:Avoid situations leading toUnexpected State:Avoid situations leading toAlter Execution Logic:NOTE:An attacker could utilize an ignored error condition to place the system in an unexpected state that could lead to the execution of unintended logic and could cause other unintended behavior.

Language-Agnostic Guidance:
::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

::PHASE:Implementation:DESCRIPTION:Properly handle each exception. This is the recommended
solution. Ensure that all exceptions are handled in such a way that you can be sure of the
state of your system at any given moment.::PHASE:Implementation:DESCRIPTION:If a function
returns an error, it is important to either fix the problem and try again, alert the user
that an error has happened and let the program continue, or alert the user and close and
cleanup the program.::PHASE:Testing:DESCRIPTION:Subject the product to extensive testing
to discover some of the possible instances of where/how errors or return values are not
handled. Consider testing techniques such as ad hoc, equivalence partitioning, robustness
and fault tolerance, mutation, and fuzzing.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
