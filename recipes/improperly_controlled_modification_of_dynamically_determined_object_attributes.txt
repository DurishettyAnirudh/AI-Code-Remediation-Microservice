cwe: CWE-915
name: Improperly Controlled Modification of Dynamically-Determined Object Attributes
languages: Ruby, ASP.NET, PHP, Python
tags: Base, Incomplete
---
Short Description:
The product receives input from an upstream component that specifies multiple attributes,
properties, or fields that are to be initialized or updated in an object, but it does not
properly control which attributes can be modified.

Secure Coding Checklist:
Do:
- PHASE:Implementation:If available, use features of the language or framework that allow specification of allowlists of attributes or fields that are allowed to be modified. If possible, prefer allowlists over denylists. For applications written with Ruby on Rails, use the attr_accessible (allowlist) or attr_protected (denylist) macros in each class that may be used in mass assignment.
- PHASE:Architecture and Design Implementation:If available, use the signing/sealing features of the programming language to assure that deserialized data has not been tainted. For example, a hash-based message authentication code (HMAC) could be used to ensure that data has not been modified.
- PHASE:Implementation:Input Validation:For any externally-influenced input, check the input against an allowlist of internal object attributes or fields that are allowed to be modified.
- PHASE:Implementation Architecture and Design:Refactoring:Refactor the code so that object attributes or fields do not need to be dynamically identified, and only expose getter/setter functionality for the intended attributes.
Don't:
- Integrity:Avoid situations leading toModify Application Data:NOTE:An attacker could modify sensitive data or program variables.
- Integrity:Avoid situations leading toExecute Unauthorized Code or Commands
- Other:Integrity:Avoid situations leading toVaries by Context:Avoid situations leading toAlter Execution Logic

Language-Agnostic Guidance:
If the object contains attributes that were only intended for internal use, then their
unexpected modification could lead to a vulnerability. This weakness is sometimes known by
the language-specific mechanisms that make it possible, such as mass assignment,
autobinding, or object injection.

::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

::PHASE:Implementation:DESCRIPTION:If available, use features of the language or framework
that allow specification of allowlists of attributes or fields that are allowed to be
modified. If possible, prefer allowlists over denylists. For applications written with
Ruby on Rails, use the attr_accessible (allowlist) or attr_protected (denylist) macros in
each class that may be used in mass assignment.::PHASE:Architecture and Design
Implementation:DESCRIPTION:If available, use the signing/sealing features of the
programming language to assure that deserialized data has not been tainted. For example, a
hash-based message authentication code (HMAC) could be used to ensure that data has not
been modified.::PHASE:Implementation:STRATEGY:Input Validation:DESCRIPTION:For any
externally-influenced input, check the input against an allowlist of internal object
attributes or fields that are allowed to be modified.::PHASE:Implementation Architecture
and Design:STRATEGY:Refactoring:DESCRIPTION:Refactor the code so that object attributes or
fields do not need to be dynamically identified, and only expose getter/setter
functionality for the intended attributes.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
