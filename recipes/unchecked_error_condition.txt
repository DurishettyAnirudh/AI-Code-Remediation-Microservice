cwe: CWE-391
name: Unchecked Error Condition
languages: unspecified
tags: Base, Incomplete
---
Short Description:
[PLANNED FOR DEPRECATION. SEE MAINTENANCE NOTES AND CONSIDER CWE-252, CWE-248, OR
CWE-1069.] Ignoring exceptions and other error conditions may allow an attacker to induce
unexpected behavior unnoticed.

Secure Coding Checklist:
Do:
- PHASE:Requirements:The choice between a language which has named or unnamed exceptions needs to be done. While unnamed exceptions exacerbate the chance of not properly dealing with an exception, named exceptions suffer from the up call version of the weak base class problem.
- PHASE:Requirements:A language can be used which requires, at compile time, to catch all serious exceptions. However, one must make sure to use the most current version of the API as new exceptions could be added.
- PHASE:Implementation:Catch all relevant exceptions. This is the recommended solution. Ensure that all exceptions are handled in such a way that you can be sure of the state of your system at any given moment.
Don't:
- Integrity:Other:Avoid situations leading toVaries by Context:Avoid situations leading toUnexpected State:Avoid situations leading toAlter Execution Logic

Language-Agnostic Guidance:
::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

::PHASE:Requirements:DESCRIPTION:The choice between a language which has named or unnamed
exceptions needs to be done. While unnamed exceptions exacerbate the chance of not
properly dealing with an exception, named exceptions suffer from the up call version of
the weak base class problem.::PHASE:Requirements:DESCRIPTION:A language can be used which
requires, at compile time, to catch all serious exceptions. However, one must make sure to
use the most current version of the API as new exceptions could be
added.::PHASE:Implementation:DESCRIPTION:Catch all relevant exceptions. This is the
recommended solution. Ensure that all exceptions are handled in such a way that you can be
sure of the state of your system at any given moment.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
