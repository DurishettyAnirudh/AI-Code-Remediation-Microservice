cwe: CWE-825
name: Expired Pointer Dereference
languages: C, C++
tags: Base, Incomplete, Memory Management
---
Short Description:
The product dereferences a pointer that contains a location for memory that was previously
valid, but is no longer valid.

Secure Coding Checklist:
Do:
- PHASE:Architecture and Design:Choose a language that provides automatic memory management.
- PHASE:Implementation:When freeing pointers, be sure to set them to NULL once they are freed. However, the utilization of multiple or complex data structures may lower the usefulness of this strategy.
Don't:
- Confidentiality:Avoid situations leading toRead Memory:NOTE:If the expired pointer is used in a read operation, an attacker might be able to control data read in by the application.
- Availability:Avoid situations leading toDoS: Crash, Exit, or Restart:NOTE:If the expired pointer references a memory location that is not accessible to the product, or points to a location that is malformed (such as NULL) or larger than expected by a read or write operation, then a crash may occur.
- Integrity:Confidentiality:Availability:Avoid situations leading toExecute Unauthorized Code or Commands:NOTE:If the expired pointer is used in a function call, or points to unexpected data in a write operation, then code execution may be possible.

Language-Agnostic Guidance:
When a product releases memory, but it maintains a pointer to that memory, then the memory
might be re-allocated at a later time. If the original pointer is accessed to read or
write data, then this could cause the product to read or modify data that is in use by a
different function or process. Depending on how the newly-allocated memory is used, this
could lead to a denial of service, information exposure, or code execution.

::PHASE:Architecture and Design:DESCRIPTION:Choose a language that provides automatic
memory management.::PHASE:Implementation:DESCRIPTION:When freeing pointers, be sure to set
them to NULL once they are freed. However, the utilization of multiple or complex data
structures may lower the usefulness of this strategy.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
