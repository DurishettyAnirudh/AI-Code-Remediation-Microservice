cwe: CWE-410
name: Insufficient Resource Pool
languages: unspecified
tags: Class, Incomplete
---
Short Description:
The product's resource pool is not large enough to handle peak demand, which allows an
attacker to prevent others from accessing the resource by using a (relatively) large
number of requests for resources.

Secure Coding Checklist:
Do:
- PHASE:Architecture and Design:Do not perform resource-intensive transactions for unauthenticated users and/or invalid requests.
- PHASE:Architecture and Design:Consider implementing a velocity check mechanism which would detect abusive behavior.
- PHASE:Operation:Consider load balancing as an option to handle heavy loads.
- PHASE:Implementation:Make sure that resource handles are properly closed when no longer needed.
- PHASE:Architecture and Design:Identify the system's resource intensive operations and consider protecting them from abuse (e.g. malicious automated script which runs the resources out).
Don't:
- Availability:Integrity:Other:Avoid situations leading toDoS: Crash, Exit, or Restart:Avoid situations leading toOther:NOTE:Floods often cause a crash or other problem besides denial of the resource itself; these are likely examples of *other* vulnerabilities, not an insufficient resource pool.

Language-Agnostic Guidance:
Frequently the consequence is a flood of connection or sessions.

::PHASE:Architecture and Design:DESCRIPTION:Do not perform resource-intensive transactions
for unauthenticated users and/or invalid requests.::PHASE:Architecture and
Design:DESCRIPTION:Consider implementing a velocity check mechanism which would detect
abusive behavior.::PHASE:Operation:DESCRIPTION:Consider load balancing as an option to
handle heavy loads.::PHASE:Implementation:DESCRIPTION:Make sure that resource handles are
properly closed when no longer needed.::PHASE:Architecture and Design:DESCRIPTION:Identify
the system's resource intensive operations and consider protecting them from abuse (e.g.
malicious automated script which runs the resources out).::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
