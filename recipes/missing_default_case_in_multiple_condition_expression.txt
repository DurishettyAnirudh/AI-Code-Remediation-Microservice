cwe: CWE-478
name: Missing Default Case in Multiple Condition Expression
languages: C, C++, Java, C#, Python, JavaScript
tags: Base, Draft
---
Short Description:
The code does not have a default case in an expression with multiple conditions, such as a
switch statement.

Secure Coding Checklist:
Do:
- PHASE:Implementation:Ensure that there are no cases unaccounted for when adjusting program flow or values based on the value of a given variable. In the case of switch style statements, the very simple act of creating a default case can, if done correctly, mitigate this situation. Often however, the default case is used simply to represent an assumed option, as opposed to working as a check for invalid input. This is poor practice and in some cases is as bad as omitting a default case entirely.
Don't:
- Integrity:Avoid situations leading toVaries by Context:Avoid situations leading toAlter Execution Logic:NOTE:Depending on the logical circumstances involved, any consequences may result: e.g., issues of confidentiality, authentication, authorization, availability, integrity, accountability, or non-repudiation.

Language-Agnostic Guidance:
If a multiple-condition expression (such as a switch in C) omits the default case but does
not consider or handle all possible values that could occur, then this might lead to
complex logical errors and resultant weaknesses. Because of this, further decisions are
made based on poor information, and cascading failure results. This cascading failure may
result in any number of security issues, and constitutes a significant failure in the
system.

::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

::PHASE:Implementation:DESCRIPTION:Ensure that there are no cases unaccounted for when
adjusting program flow or values based on the value of a given variable. In the case of
switch style statements, the very simple act of creating a default case can, if done
correctly, mitigate this situation. Often however, the default case is used simply to
represent an assumed option, as opposed to working as a check for invalid input. This is
poor practice and in some cases is as bad as omitting a default case entirely.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
