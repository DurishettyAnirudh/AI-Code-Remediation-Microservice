cwe: CWE-257
name: Storing Passwords in a Recoverable Format
languages: unspecified
tags: Base, Incomplete
---
Short Description:
The storage of passwords in a recoverable format makes them subject to password reuse
attacks by malicious users. In fact, it should be noted that recoverable encrypted
passwords provide no significant benefit over plaintext passwords since they are subject
not only to reuse by malicious attackers but also by malicious insiders. If a system
administrator can recover a password directly, or use a brute force search on the
available information, the administrator can use the password on other accounts.

Secure Coding Checklist:
Do:
- PHASE:Architecture and Design:Use strong, non-reversible encryption to protect stored passwords.
Don't:
- Confidentiality:Access Control:Avoid situations leading toGain Privileges or Assume Identity:NOTE:User's passwords may be revealed.
- Access Control:Avoid situations leading toGain Privileges or Assume Identity:NOTE:Revealed passwords may be reused elsewhere to impersonate the users in question.

Language-Agnostic Guidance:
::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

::PHASE:Architecture and Design:DESCRIPTION:Use strong, non-reversible encryption to
protect stored passwords.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
