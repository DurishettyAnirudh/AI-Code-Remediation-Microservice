cwe: CWE-654
name: Reliance on a Single Factor in a Security Decision
languages: unspecified
tags: Base, Draft
---
Short Description:
A protection mechanism relies exclusively, or to a large extent, on the evaluation of a
single condition or the integrity of a single object or entity in order to make a decision
about granting access to restricted resources or functionality.

Secure Coding Checklist:
Do:
- PHASE:Architecture and Design:Use multiple simultaneous checks before granting access to critical operations or granting critical privileges. A weaker but helpful mitigation is to use several successive checks (multiple layers of security).
- PHASE:Architecture and Design:Use redundant access rules on different choke points (e.g., firewalls).
Don't:
- Access Control:Avoid situations leading toGain Privileges or Assume Identity:NOTE:If the single factor is compromised (e.g. by theft or spoofing), then the integrity of the entire security mechanism can be violated with respect to the user that is identified by that factor.
- Non-Repudiation:Avoid situations leading toHide Activities:NOTE:It can become difficult or impossible for the product to be able to distinguish between legitimate activities by the entity who provided the factor, versus illegitimate activities by an attacker.

Language-Agnostic Guidance:
::PHASE:Architecture and Design:DESCRIPTION:Use multiple simultaneous checks before
granting access to critical operations or granting critical privileges. A weaker but
helpful mitigation is to use several successive checks (multiple layers of
security).::PHASE:Architecture and Design:DESCRIPTION:Use redundant access rules on
different choke points (e.g., firewalls).::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
