cwe: CWE-581
name: Object Model Violation: Just One of Equals and Hashcode Defined
languages: Java
tags: Draft, Variant
---
Short Description:
The product does not maintain equal hashcodes for equal objects.

Secure Coding Checklist:
Do:
- PHASE:Implementation:Both Equals() and Hashcode() should be defined.
Don't:
- Integrity:Other:Avoid situations leading toOther:NOTE:If this invariant is not upheld, it is likely to cause trouble if objects of this class are stored in a collection. If the objects of the class in question are used as a key in a Hashtable or if they are inserted into a Map or Set, it is critical that equal objects have equal hashcodes.

Language-Agnostic Guidance:
Java objects are expected to obey a number of invariants related to equality. One of these
invariants is that equal objects must have equal hashcodes. In other words, if a.equals(b)
== true then a.hashCode() == b.hashCode().

::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

::PHASE:Implementation:DESCRIPTION:Both Equals() and Hashcode() should be defined.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
