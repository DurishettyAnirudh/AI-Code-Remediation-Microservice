cwe: CWE-641
name: Improper Restriction of Names for Files and Other Resources
languages: unspecified
tags: Base, Incomplete
---
Short Description:
The product constructs the name of a file or other resource using input from an upstream
component, but it does not restrict or incorrectly restricts the resulting name.

Secure Coding Checklist:
Do:
- PHASE:Architecture and Design:Do not allow users to control names of resources used on the server side.
- PHASE:Architecture and Design:Perform allowlist input validation at entry points and also before consuming the resources. Reject bad file names rather than trying to cleanse them.
- PHASE:Architecture and Design:Make sure that technologies consuming the resources are not vulnerable (e.g. buffer overflow, format string, etc.) in a way that would allow code execution if the name of the resource is malformed.
Don't:
- Integrity:Confidentiality:Availability:Avoid situations leading toExecute Unauthorized Code or Commands:NOTE:Execution of arbitrary code in the context of usage of the resources with dangerous names.
- Confidentiality:Availability:Avoid situations leading toRead Application Data:Avoid situations leading toDoS: Crash, Exit, or Restart:NOTE:Crash of the consumer code of these resources resulting in information leakage or denial of service.

Language-Agnostic Guidance:
This may produce resultant weaknesses. For instance, if the names of these resources
contain scripting characters, it is possible that a script may get executed in the
client's browser if the application ever displays the name of the resource on a
dynamically generated web page. Alternately, if the resources are consumed by some
application parser, a specially crafted name can exploit some vulnerability internal to
the parser, potentially resulting in execution of arbitrary code on the server machine.
The problems will vary based on the context of usage of such malformed resource names and
whether vulnerabilities are present in or assumptions are made by the targeted technology
that would make code execution possible.

::PHASE:Architecture and Design:DESCRIPTION:Do not allow users to control names of
resources used on the server side.::PHASE:Architecture and Design:DESCRIPTION:Perform
allowlist input validation at entry points and also before consuming the resources. Reject
bad file names rather than trying to cleanse them.::PHASE:Architecture and
Design:DESCRIPTION:Make sure that technologies consuming the resources are not vulnerable
(e.g. buffer overflow, format string, etc.) in a way that would allow code execution if
the name of the resource is malformed.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
