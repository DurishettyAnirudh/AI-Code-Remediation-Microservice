cwe: CWE-580
name: clone() Method Without super.clone()
languages: Java
tags: Draft, Variant
---
Short Description:
The product contains a clone() method that does not call super.clone() to obtain the new
object.

Secure Coding Checklist:
Do:
- PHASE:Implementation:Call super.clone() within your clone() method, when obtaining a new object.
- PHASE:Implementation:In some cases, you can eliminate the clone method altogether and use copy constructors.
Don't:
- Integrity:Other:Avoid situations leading toUnexpected State:Avoid situations leading toQuality Degradation

Language-Agnostic Guidance:
All implementations of clone() should obtain the new object by calling super.clone(). If a
class does not follow this convention, a subclass's clone() method will return an object
of the wrong type.

::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

::PHASE:Implementation:DESCRIPTION:Call super.clone() within your clone() method, when
obtaining a new object.::PHASE:Implementation:DESCRIPTION:In some cases, you can eliminate
the clone method altogether and use copy constructors.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
