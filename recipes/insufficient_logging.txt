cwe: CWE-778
name: Insufficient Logging
languages: unspecified
tags: Base, Draft
---
Short Description:
When a security-critical event occurs, the product either does not record the event or
omits important details about the event when logging it.

Secure Coding Checklist:
Do:
- PHASE:Architecture and Design:Use a centralized logging mechanism that supports multiple levels of detail.
- PHASE:Implementation:Ensure that all security-related successes and failures can be logged. When storing data in the cloud (e.g., AWS S3 buckets, Azure blobs, Google Cloud Storage, etc.), use the provider's controls to enable and capture detailed logging information.
- PHASE:Operation:Be sure to set the level of logging appropriately in a production environment. Sufficient data should be logged to enable system administrators to detect attacks, diagnose errors, and recover from attacks. At the same time, logging too much data (CWE-779) can cause the same problems, including unexpected costs when using a cloud environment.
- PHASE:Operation:To enable storage logging using Azure's Portal, navigate to the name of the Storage Account, locate Monitoring (CLASSIC) section, and select Diagnostic settings (classic). For each of the various properties (blob, file, table, queue), ensure the status is properly set for the desired logging data. If using PowerShell, the Set-AzStorageServiceLoggingProperty command could be called using appropriate -ServiceType, -LoggingOperations, and -RetentionDays arguments.
Don't:
- Non-Repudiation:Avoid situations leading toHide Activities:NOTE:If security critical information is not recorded, there will be no trail for forensic analysis and discovering the cause of problems or the source of attacks may become more difficult or impossible.

Language-Agnostic Guidance:
When security-critical events are not logged properly, such as a failed login attempt,
this can make malicious behavior more difficult to detect and may hinder forensic analysis
after an attack succeeds. As organizations adopt cloud storage resources, these
technologies often require configuration changes to enable detailed logging information,
since detailed logging can incur additional costs. This could lead to telemetry gaps in
critical audit logs. For example, in Azure, the default value for logging is disabled.

::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

::PHASE:Architecture and Design:DESCRIPTION:Use a centralized logging mechanism that
supports multiple levels of detail.::PHASE:Implementation:DESCRIPTION:Ensure that all
security-related successes and failures can be logged. When storing data in the cloud
(e.g., AWS S3 buckets, Azure blobs, Google Cloud Storage, etc.), use the provider's
controls to enable and capture detailed logging
information.::PHASE:Operation:DESCRIPTION:Be sure to set the level of logging
appropriately in a production environment. Sufficient data should be logged to enable
system administrators to detect attacks, diagnose errors, and recover from attacks. At the
same time, logging too much data (CWE-779) can cause the same problems, including
unexpected costs when using a cloud environment.::PHASE:Operation:DESCRIPTION:To enable
storage logging using Azure's Portal, navigate to the name of the Storage Account, locate
Monitoring (CLASSIC) section, and select Diagnostic settings (classic). For each of the
various properties (blob, file, table, queue), ensure the status is properly set for the
desired logging data. If using PowerShell, the Set-AzStorageServiceLoggingProperty command
could be called using appropriate -ServiceType, -LoggingOperations, and -RetentionDays
arguments.::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
