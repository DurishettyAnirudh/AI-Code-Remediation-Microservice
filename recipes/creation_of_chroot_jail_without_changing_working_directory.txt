cwe: CWE-243
name: Creation of chroot Jail Without Changing Working Directory
languages: C, C++
tags: Draft, Variant
---
Short Description:
The product uses the chroot() system call to create a jail, but does not change the
working directory afterward. This does not prevent access to files outside of the jail.

Secure Coding Checklist:
Do:
- Apply least privilege, validate input, and follow vendor hardening guides.
Don't:
- Confidentiality:Avoid situations leading toRead Files or Directories

Language-Agnostic Guidance:
Improper use of chroot() may allow attackers to escape from the chroot jail. The chroot()
function call does not change the process's current working directory, so relative paths
may still refer to file system resources outside of the chroot jail after chroot() has
been called.

::METHOD:Automated Static Analysis:DESCRIPTION:Automated static analysis, commonly
referred to as Static Application Security Testing (SAST), can find some instances of this
weakness by analyzing source code (or binary/compiled code) without having to execute it.
Typically, this is done by building a model of data flow and control flow, then searching
for potentially-vulnerable patterns that connect sources (origins of input) with sinks
(destinations where the data interacts with external components, a lower layer such as the
OS, etc.):EFFECTIVENESS:High::

Sample Fix Idea (Pseudo-code):
```pseudo
# High-level remediation stub
if receives_untrusted_input():
    validate_against_allowlist()
    enforce_least_privilege()
    log_and_monitor()
```
